<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="Setup of the operators"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_page"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>Setup of the operators</title>
</head>
<body id="spldoc_page">


<h1 class="title topictitle1">Setup of the operators</h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Message Hub Toolkit</a> &gt; <a class="xref" href="tk$com.ibm.streamsx.messagehub.html">com.ibm.streamsx.messagehub 3.0.4</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.messagehub.html">com.ibm.streamsx.messagehub</a> &gt; Setup of the operators</p>

</div>


<div class="section">
<p class="p">When you create an instance of the IBM Event Streams service, you must also create credentials to use the service. These credentials are given in JSON format. This piece of information is required to setup the operators  to connect to the service instance.
</p>

<p class="p">Any of the following options can be used to configure the operator for connecting to IBM Cloud.
</p>

<div class="p">
<ul class="ul">
<li class="li"> save the credentials in an application configuration - this is the best way to protect your sensitive data</li>

<li class="li"> save the credentials in a file, which is bundled with the Streams application bundle</li>

<li class="li"> specify the credentials as <strong class="ph b">credentials</strong> operator parameter. Any SPL rstring expression can be specified as operator parameter, for example <tt class="ph tt">getSubmissionTimeValue("credentials");</tt>.</li>

</ul>

</div>

<div class="p">The priority of the above options is
<ol class="ol">
<li class="li"> <strong class="ph b">credentials</strong> operator parameter (both file and application config are ignored)</li>

<li class="li"> credentials stored in a file, also when the default filename <tt class="ph tt">eventstreams.json</tt> is used (application config is ignored)</li>

<li class="li"> application configuration</li>

</ol>

</div>

</div>

<div class="section"><h2 class="title sectiontitle">Save Credentials in Application Configuration Property
</h2>

<p class="p">With this option, users can copy their Event Streams Credentials JSON from the Event Streams service  and store it in an application configuration property named <tt class="ph tt">eventstreams.creds</tt>.  When the operator starts, it will look for that property and extract the information needed to connect. The following steps outline how this can be done:
</p>

<div class="p">
<ol class="ol">
<li class="li"> Create an application configuration with the name <strong class="ph b">eventstreams</strong>.</li>

<li class="li"> Create a property in the eventstreams application configuration with the name <tt class="ph tt">eventstreams.creds</tt>.</li>

<li class="li"> The value of the property must be the raw Event Streams Credentials JSON.</li>

<li class="li"> The operator will automatically look for an application configuration named eventstreams and will extract the information needed to connect.</li>

</ol>

</div>

<p class="p"><strong class="ph b">NOTE 1:</strong> Users can specify a different application configuration name by setting the <strong class="ph b">appConfigName</strong> parameter. The operator will still look for a property with the name <tt class="ph tt">eventstreams.creds</tt> containing the Event Streams Credentials JSON.
</p>

<p class="p"><strong class="ph b">NOTE 2:</strong> Users can add generic Kafka properties, for example <tt class="ph tt">metadata.max.age.ms</tt>, to the application configuration. To make the operator use these Kafka properties, the <strong class="ph b">appConfigName</strong> parameter must be specified even if the default application configuration name <tt class="ph tt">eventstreams</tt> is used. Looking at the other way round, when the default application configuration name <tt class="ph tt">eventstreams</tt> is used, but <em class="ph i">not</em> specified as <strong class="ph b">appConfigName</strong> parameter value,  only the service credentials are used from the application configuration.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Save Credentials in a File
</h2>

<p class="p">With this option, users can copy their Event Streams credentials JSON from the Event Streams service and store it in a file called <tt class="ph tt">eventstreams.json</tt>. When the operator starts up it will read the credentials from that file and extract the information needed to connect. The following steps outline how this can be done:
</p>

<div class="p">
<ol class="ol">
<li class="li"> Create a file with the name <tt class="ph tt">eventstreams.json</tt> in the &lt;application_directory&gt;/etc/ directory.</li>

<li class="li"> Paste the Event Streams Credentials JSON into this file and save it.</li>

<li class="li"> The operator will automatically look for the file &lt;application_directory&gt;/etc/eventstreams.json and will extract the information needed to connect. Users only need to specify the topic(s) that they wish to consume messages from (set via the topic parameter).</li>

</ol>

</div>

<p class="p"><strong class="ph b">NOTE:</strong> Users can use the <strong class="ph b">credentialsFile</strong> parameter to specify a different file containing the Event Streams Credentials in JSON format.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Use the <tt class="ph tt">credentials</tt> operator parameter
</h2>

<p class="p">With this option, any SPL expression that returns an <tt class="ph tt">rstring</tt> can be used to specify the service credentials. For example,  you can write and use an SPL function, which reads the credentials JSON from a key value store.
</p>

<p class="p"><strong class="ph b">The following Kafka properties are setup by the operators by default as recommended by Event Streams:</strong>
</p>

<div class="p">

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">


<thead class="thead" align="left">
<tr class="row">
<th class="entry" colspan="1" valign="top" id="d3202e221">
<p class="p">property name
</p>

</th>

<th class="entry" colspan="1" valign="top" id="d3202e227">
<p class="p">value
</p>

</th>

</tr>

</thead>

<tbody class="tbody">
<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">bootstrap.servers
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p"><em class="ph i">parsed from the service credentials</em>
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">sasl.jaas.config
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">org.apache.kafka.common.security.plain.PlainLoginModule required   serviceName="kafka"   username="<em class="ph i">username</em>"   password="<em class="ph i">password</em>";
</p>

<p class="p">(The <em class="ph i">username</em> and the <em class="ph i">password</em> are extracted from the service credentials.)
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">security.protocol
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">SASL_SSL
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">sasl.mechanism
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">PLAIN
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">ssl.protocol
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">TLSv1.2
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">ssl.truststore.type
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">JKS
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">ssl.enabled.protocols
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">TLSv1.2
</p>

</td>

</tr>

<tr class="row">
<td class="entry" colspan="1" valign="top" headers="d3202e221 ">
<p class="p">ssl.endpoint.identification.algorithm
</p>

</td>

<td class="entry" colspan="1" valign="top" headers="d3202e227 ">
<p class="p">HTTPS
</p>

</td>

</tr>

</tbody>

</table>
</div>

</div>

<p class="p">These properties cannot be overwritten by specific Kafka properties provided via properties file or application configuration. They are ignored when specified in a property file or application configuration.
</p>

<p class="p">In addition to the properties above, some more properties are setup or adjusted specific for the operators. For reference, review the operator's documentation.
</p>

</div>

</div>


</body>
</html>